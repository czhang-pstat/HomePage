---
title: Recovering probability densities from tangent spaces
author: Chao Zhang
date: 2019-04-30
hero: ./images/cover.jpeg
excerpt: Now that we have a tangent space element, what to do to recover the probability density function?
---

## Hello, probability density functions

Throughtout the course of history of statistical inference, estimating the data generative process constitues a significant thrust for methodology developments.  Probability density functions (pdfs), being one of the various characterizations of such underlying proccesses, become a natrual subject of study.  With the rapid adoption of modern sensors which collect high frequency signals, it is increasingly likely the case that each observed data sample is associated with its own distribution.  In this case, one is interested in studying the heterogeneity among the generating processes rather than the processes per se.  The shift from viewing pdfs as models of random observations to individual observations of a meta-generative process on the space of distributions is now hitting its stride.[^1]

## Ok, so what is so hard about modeling pdfs as data atoms?

Well, for starters, pdfs are intrinsically infinite-dimensional objects, which are rarely, if ever, fully observed.  In other words, a collection of measurable maps from an underlying probability space assumes values in a space of densities, and observable samples are further generated by the random mechanisms specified by these densities.  Therefore, estimation of densities needs to be done, and inccured deviations need to be accounted for.

To further complicate matters, densities do not constitue a vector space, which renders every single well-established linear methods hopeless.  Several attempts have been to clear these hurdles.  For instance, the LQD transformation, the Bayes space isomorphism, and the geometric approach with Wasserstein and Fisher-Rao metrics.

The rest of this post will focus on the case of the Wasserstein geometry.  While being admittedly biased as my recent work was centered in the Wasserstein geometry, I do believe this is a promising framework in this competitive landscape.

## Wasserstein geometry is also known as the eath mover's distance, so let's grab our shovels

A thorough account of the work behind the Wassersetin geometry is clearly beyond the scope of what this post aims to serve, so we will just look at the simple case of probability measures on $\mathbb{R}$ with finite second moments, i.e., $\mathcal{W}_2 = \\{ \mu: \int x \, \mathrm{d} \mu(x) <\infty\\}$.  Denote by $\mathcal{D}$ the subset of $\mathcal{W}_2$ which admits densities, i.e., absolute continuous with respect to the Lebesgue measure.

For any two measures $\mu$, $\nu \in \mathcal{W}_2$, with corresponding cumulative distribution functions (cdfs) $F$, $G$, respectively, the Wasserstein distance between the two distributions addmits a closed form

$$
d_W(F,G) = \int_0^1 (F^{-1}(s) - G^{-1}(s)) \mathrm{d}s.
$$

Denote $\mu\_{\oplus}$ the template measure of the random measures that take values in $\mathcal{W}\_2$.  There exists an isometric isomorphism between $\mathcal{W}\_2$ and the tangent space $\mathcal{T}\_{\mu\_\oplus}$, which is a separable Hilbert space -- this nice Hilbertian strucure does most of the heavy lifting.

Let's skip forward a bit and jump to our main topic.  Suppose we are able to obtain an optimal transport map $T = F^{-1} \circ F\_{\oplus}$ in tangent space with $F\_\oplus$ being the template cdf (the other cases will be updated later this week).  Let's take a look at how we can revocer densities from a numerical perspective.

## Approach I: Differentiation and interpolation

Based on the definition $T(u) = F^{-1} \circ F\_{\oplus}(u)$, one can simply...


$\mathcal{W}_2$.






$3^2$ My first post using `@narative/gatsby-theme-novela`. Novela is built by the team at [Narative](https://narative.co), and built for everyone that loves the web.

## Headers

# H1

It is recommended to NOT use H1s as it is reserved for the article heading. Any H1 is set as an H2.

## H2

### H3

#### H4

##### H5

###### H6

## Emphasis

Emphasis, aka italics, with _asterisks_ or _underscores_.

Strong emphasis, aka bold, with **asterisks** or **underscores**.

Combined emphasis with **asterisks and _underscores_**.

Strikethrough uses two tildes. ~~Scratch this.~~

## Lists

1. First ordered list item
2. Another item
3. Actual numbers don't matter, just that it's a number

- Unordered list can use asterisks

* Or minuses

- Or pluses

## Links

[I'm an inline-style link](https://www.google.com)

[I'm an inline-style link with title](https://www.google.com "Google's Homepage")

[I'm a reference-style link][arbitrary case-insensitive reference text]

[I'm a relative reference to a repository file](../blob/master/LICENSE)

[You can use numbers for reference-style link definitions][1]

Or leave it empty and use the [link text itself].

URLs and URLs in angle brackets will automatically get turned into links.
http://www.example.com or <http://www.example.com> and sometimes
example.com (but not on Github, for example).

Some text to show that the reference links can follow later.

[arbitrary case-insensitive reference text]: https://www.mozilla.org
[1]: http://slashdot.org
[link text itself]: http://www.reddit.com

## Images

<div className="Image__Small">
  <img
    src="./images/article-image-2.jpg"
    title="Logo Title Text 1"
    alt="Alt text"
  />
</div>

Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. Lorem Ipsum is simply dummy text of the printing and typesetting industry.

## Code and Syntax Highlighting

```javascript
var s = "JavaScript syntax highlighting";
alert(s);
```

```
No language indicated, so no syntax highlighting.
But let's throw in a <b>tag</b>.
```

### JSX

```jsx
import React from "react";
import { ThemeProvider } from "theme-ui";
import theme from "./theme";

export default props => (
  <ThemeProvider theme={theme}>{props.children}</ThemeProvider>
);
```

## Blockquotes

Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing.

> Blockquotes are very handy in email to emulate reply text.
> This line is part of the same quote.

Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum

## Horizontal Rule

Horizontal Rule

Three or more...

---

Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum

---

Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum
